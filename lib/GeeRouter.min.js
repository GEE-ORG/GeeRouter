!function(t,h){"object"==typeof exports&&"undefined"!=typeof module?module.exports=h():"function"==typeof define&&define.amd?define(h):t.GeeRouter=h()}(this,function(){"use strict";var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h=function(t,h){if(!(t instanceof h))throw new TypeError("Cannot call a class as a function")},e=function(){function t(t,h){for(var e=0;e<h.length;e++){var i=h[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(h,e,i){return e&&t(h.prototype,e),i&&t(h,i),h}}();return function(){function i(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];h(this,i),this._hash="",this.from={path:"",fullPath:location.href},this.to={path:"",fullPath:location.href},this.history=[],this.historyAnchor=-1,this.beforeEachFuncs=[],this.afterEachFuncs=[],this.origin=location.protocol+"//"+location.host+location.pathname,this.routes=e,this.defaultPath="/",this.page404=function(){},this.path2Ele={},this.curActive=null,this.routes.forEach(function(h){h.default&&(t.defaultPath=h.path),"*"===h.path&&(t.page404=h.handler)})}return e(i,[{key:"start",value:function(){var t=this;window.addEventListener("hashchange",function(){t.hashName=location.hash.replace("#!",""),console.log(t.hashName)}),this.firstPage()}},{key:"parse",value:function(t){var h=this;"string"==typeof t&&(t=document.querySelectorAll(t)),(t instanceof NodeList||t instanceof HTMLCollection||t instanceof Node)&&(Array.from(t,function(t){if("A"===t.tagName){var e=t.pathname;t.setAttribute("href","#!"+e),console.log(h.path2Ele),h.path2Ele[e]?(h.path2Ele[e]=[h.path2Ele[e]],h.path2Ele[e].push(t)):h.path2Ele[e]=t}}),console.log(this.path2Ele))}},{key:"firstPage",value:function(){""!==location.hash?this.hashName=location.hash.replace("#!",""):location.hash="!"+this.defaultPath}},{key:"hashChange",value:function(h){var e=this;if(this.routes.length){var i=function(){for(var i=h.from,o=h.to,a=e.beforeEachFuncs.length-1,s=e.routes.length-1,n=0;n<=s;n++){var r=function(t){var h=e.routes[t];if(e.hashName===h.path){if(e.beforeEachFuncs.length){var s=0,n=function t(){s<a?e.beforeEachFuncs[++s](i,o,t):h.handler({from:i,to:o})};e.beforeEachFuncs[0](i,o,n)}else h.handler({from:i,to:o});if(e.afterEachFuncs.length)for(var r=0;r<e.afterEachFuncs.length;r++)e.afterEachFuncs[r]();return{v:{v:void 0}}}}(n);if("object"===(void 0===r?"undefined":t(r)))return r.v}if(e.beforeEachFuncs.length){var c=0,f=function t(){c<a?e.beforeEachFuncs[++c](i,o,t,"404"):e.page404({from:i,to:o})};e.beforeEachFuncs[0](i,o,f,"404")}else e.page404({from:i,to:o})}();if("object"===(void 0===i?"undefined":t(i)))return i.v}}},{key:"beforeEach",value:function(t){return this.beforeEachFuncs.push(t),t(this.from,this.to,function(){}),this}},{key:"afterEach",value:function(t){return this.afterEachFuncs.push(t),t(this.from,this.to),this}},{key:"back",value:function(){this.history.length<2||(this.hashName=this.history[this.historyAnchor-1])}},{key:"go",value:function(t){t>0&&this.history.length-1-this.historyAnchor>=t&&(this.hashName=this.history[this.historyAnchor-t]),t<0&&this.historyAnchor>=Math.abs(t)&&(this.hashName=this.history[this.historyAnchor+t])}},{key:"hashName",get:function(){return this._hash},set:function(t){this.from.path=this.hashName,this.from.fullPath=this.origin+"#!"+this.hashName,this._hash=t,this.to.path=this.hashName,this.to.fullPath=this.origin+"#!"+this.hashName,this.history.push(this.hashName),this.historyAnchor+=1,this.hashChange({from:this.from,to:this.to}),this.curActive&&(Array.isArray(this.path2Ele[this.curActive])?this.path2Ele[this.curActive].forEach(function(t){t.classList.remove("active")}):this.path2Ele[this.curActive].classList.remove("active")),Array.isArray(this.path2Ele[this.to.path])?this.path2Ele[this.to.path].forEach(function(t){t.classList.add("active")}):this.path2Ele[this.to.path].classList.add("active"),this.curActive=this.to.path}}]),i}()});
