!function(t,h){"object"==typeof exports&&"undefined"!=typeof module?module.exports=h():"function"==typeof define&&define.amd?define(h):t.GeeRouter=h()}(this,function(){"use strict";var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h=function(t,h){if(!(t instanceof h))throw new TypeError("Cannot call a class as a function")},e=function(){function t(t,h){for(var e=0;e<h.length;e++){var i=h[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(h,e,i){return e&&t(h.prototype,e),i&&t(h,i),h}}();return function(){function i(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];h(this,i),this._hash="",this.from={path:"",fullPath:location.href},this.to={path:"",fullPath:location.href},this.historyMod=a,this.history=[],this.historyAnchor=-1,this.beforeEachFuncs=[],this.afterEachFuncs=[],this.origin=location.protocol+"//"+location.host+location.pathname,this.routes=e,this.defaultPath="/",this.page404=function(){},this.path2Ele={},this.curActive=null,this.routes.forEach(function(h){h.default&&(t.defaultPath=h.path),"*"===h.path&&(t.page404=h.handler)})}return e(i,[{key:"start",value:function(){var t=this;this.historyMod?window.addEventListener("popstate",function(h){var e=h.state&&h.state.path;e&&(t.pathName=e)}):window.addEventListener("hashchange",function(){t.pathName=location.hash.replace("#!","")}),this.firstPage()}},{key:"parse",value:function(t){var h=this;"string"==typeof t&&(t=document.querySelectorAll(t)),(t instanceof NodeList||t instanceof HTMLCollection||t instanceof Node)&&Array.from(t,function(t){if("A"===t.tagName){var e=t.pathname;h.historyMod?t.addEventListener("click",function(t){t.preventDefault(),h._pushState({path:e},null,e)}):t.setAttribute("href","#!"+e),h.path2Ele[e]?(h.path2Ele[e]=[h.path2Ele[e]],h.path2Ele[e].push(t)):h.path2Ele[e]=t}})}},{key:"firstPage",value:function(){if(this.historyMod)return void(this.defaultPath&&this._pushState({path:this.defaultPath},null,this.defaultPath));""!==location.hash?this.pathName=location.hash.replace("#!",""):location.hash="!"+this.defaultPath}},{key:"_pushState",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},h=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";window.history.pushState(t,h,e),this.pathName=e}},{key:"hashChange",value:function(h){var e=this;if(this.routes.length){var i=function(){for(var i=h.from,a=h.to,o=e.beforeEachFuncs.length-1,n=e.routes.length-1,s=0;s<=n;s++){var r=function(t){var h=e.routes[t];if(e.pathName===h.path){if(e.beforeEachFuncs.length){var n=0,s=function t(){n<o?e.beforeEachFuncs[++n](i,a,t):h.handler({from:i,to:a})};e.beforeEachFuncs[0](i,a,s)}else h.handler({from:i,to:a});if(e.afterEachFuncs.length)for(var r=0;r<e.afterEachFuncs.length;r++)e.afterEachFuncs[r]();return{v:{v:void 0}}}}(s);if("object"===(void 0===r?"undefined":t(r)))return r.v}if(e.beforeEachFuncs.length){var c=0,u=function t(){c<o?e.beforeEachFuncs[++c](i,a,t,"404"):e.page404({from:i,to:a})};e.beforeEachFuncs[0](i,a,u,"404")}else e.page404({from:i,to:a})}();if("object"===(void 0===i?"undefined":t(i)))return i.v}}},{key:"beforeEach",value:function(t){return this.beforeEachFuncs.push(t),t(this.from,this.to,function(){}),this}},{key:"afterEach",value:function(t){return this.afterEachFuncs.push(t),t(this.from,this.to),this}},{key:"back",value:function(){this.history.length<2||(this.pathName=this.history[this.historyAnchor-1])}},{key:"go",value:function(t){t>0&&this.history.length-1-this.historyAnchor>=t&&(this.pathName=this.history[this.historyAnchor-t]),t<0&&this.historyAnchor>=Math.abs(t)&&(this.pathName=this.history[this.historyAnchor+t])}},{key:"pathName",get:function(){return this._hash},set:function(t){this.from.path=this.pathName,this.from.fullPath=this.origin+"#!"+this.pathName,this._hash=t,this.to.path=this.pathName,this.to.fullPath=this.origin+"#!"+this.pathName,this.history.push(this.pathName),this.historyAnchor+=1,this.hashChange({from:this.from,to:this.to}),this.curActive&&(Array.isArray(this.path2Ele[this.curActive])?this.path2Ele[this.curActive].forEach(function(t){t.classList.remove("active")}):this.path2Ele[this.curActive].classList.remove("active")),Array.isArray(this.path2Ele[this.to.path])?this.path2Ele[this.to.path].forEach(function(t){t.classList.add("active")}):this.path2Ele[this.to.path].classList.add("active"),this.curActive=this.to.path}}]),i}()});
